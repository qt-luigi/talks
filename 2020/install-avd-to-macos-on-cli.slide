Install Android Virtual Device to macOS on command line interface
Flutter Meetup Osaka #3
22 May 2020

Ryuji Iwata
Okayama, Japan
@qt_luigi

* Ryuji Iwata

.image install-avd-to-macos-on-cli/img/qt_luigi250.png 300 300

Twitter

.link http://twitter.com/qt_luigi @qt_luigi

* ãªãœã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã§Androidä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸã„ã®ã‹ï¼Ÿ

* ä½ã‚¹ãƒšãƒƒã‚¯ã®é–‹ç™ºæ©Ÿã§Flutteré–‹ç™ºã‚’ã—ãŸã„ãŸã‚

Android Studioã§ã¯ãªãVisual Studio Codeã‚’ä½¿ã„ãŸã„ã€‚

* Visual Studio Code

Flutterã‹ã‚‰å…¬å¼ã‚¨ã‚¯ã‚¹ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚‚ãƒªãƒªãƒ¼ã‚¹ã•ã‚Œã¦ã„ã‚‹ã€‚

ãƒ¡ãƒªãƒƒãƒˆ

- ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨é‡ãŒå°‘ãªã„ã€‚
- å‹•ä½œãŒè»½ã„ã€‚

ãƒ‡ãƒ¡ãƒªãƒƒãƒˆ

- Androidä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹ã‚’åˆ¥é€”ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

* Androidä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã«ã¯ï¼Ÿ

ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆã‚„æ›¸ç±ã§ã‚‚Android Studioã‚’ä½¿ã£ãŸè§£èª¬ãŒã»ã¨ã‚“ã©ã€‚

ã“ã‚Œã ã‘ã®ãŸã‚ã«Android Studioã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã®ã¯æœ¬æœ«è»¢å€’ã‹ã¨...

- ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨é‡ãŒå¢—ãˆã‚‹ã€‚

* ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã§Androidä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹ã ã‘ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã‚ˆã†ï¼

æœ¬è³‡æ–™ãŒãŠå½¹ã«ç«‹ã¦ã‚Œã°ã€ã¨ã€‚

* ä½œæ¥­ã®æµã‚Œ

* ä½œæ¥­ã®æµã‚Œ

ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

- Flutter
- Java
- Android Tools
- Androidä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹

ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

- Androidãƒ©ã‚¤ã‚»ãƒ³ã‚¹èªè¨¼

ä½œæˆ

- Androidä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹ä½œæˆ
- Flutterã‚¢ãƒ—ãƒªä½œæˆ

* æ³¨æ„ç‚¹

macOSã¯Catalina 10.15.4ã§ã€ã‚³ãƒãƒ³ãƒ‰ã‚·ã‚§ãƒ«ã¯zshã§ã™ã€‚

- å†…å®¹çš„ã«ã¯Windowsã‚„Linuxã§ã‚‚å¯¾å¿œå¯èƒ½ãªã®ã§ãƒãƒ£ãƒ¬ãƒ³ã‚¸ã‚’ï¼

ä½œæ¥­ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¼ã¯ã€Œãƒ›ãƒ¼ãƒ ã€ã§ã™ã€‚

  % pwd
  /Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å

å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã¯.pkgãƒ•ã‚¡ã‚¤ãƒ«ã‚ˆã‚Šã‚‚.zip/.tar.gzãƒ•ã‚¡ã‚¤ãƒ«ã‚’å„ªå…ˆã—ã¦ã„ã¾ã™ã€‚

* Flutter

* ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

.link https://flutter.dev/docs/development/tools/sdk/releases?tab=macos

[å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] flutter_macos_1.17.1-stable.zip

.image install-avd-to-macos-on-cli/img/flutter.png 450 720

* ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã—ã¦å±•é–‹ã€‚

  % unzip Downloads/flutter_macos_1.17.1-stable.zip

å±•é–‹ã•ã‚ŒãŸã€Œflutter/ã€ã‚’ã€Œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³/ã€é…ä¸‹ã«ç§»å‹•ã€‚

  % mv flutter/ Applications/

* ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

ä»»æ„ã®ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã§.zshrcãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€ãƒ‘ã‚¹ã‚’è¿½åŠ ã—ã¦ä¿å­˜ã€‚

  export PATH=$PATH:/Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/Applications/flutter/bin

zshrcãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿ç›´ã™ã€‚

  % source .zshrc

å‹•ä½œã‚’ç¢ºèªã€‚

  % flutter --version
  Flutter 1.17.1 â€¢ channel stable â€¢ https://github.com/flutter/flutter.git
  Framework â€¢ revision f7a6a7906b (3 days ago) â€¢ 2020-05-12 18:39:00 -0700
  Engine â€¢ revision 6bc433c6b6
  Tools â€¢ Dart 2.8.2

* Java

* ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã¨ç¨®é¡

Androidé–‹ç™ºã§ã¯ãƒãƒ¼ã‚¸ãƒ§ãƒ³8ãŒå¿…è¦ã€‚

ã€Œç‹¬è‡ªJDKã€ã¨ã€ŒOpenJDKã€ãŒã‚ã‚‹ãŒã€ã©ã¡ã‚‰ã§ã‚‚ã‚ˆã„ã€‚

* å…¥æ‰‹å¯èƒ½ãªå®Ÿè¡Œãƒã‚¤ãƒŠãƒªãƒ¼å½¢å¼ã®macOSç‰ˆ JDK 8

ç‹¬è‡ªJDK

- Oracle JDKï¼ˆOracleãƒ—ãƒ­ãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®ã‚µã‚¤ãƒ³ã‚¤ãƒ³ãŒå¿…è¦ï¼‰

OpenJDK

- AdoptOpenJDK
- Zulu Community

* Oracle JDK

.link https://www.oracle.com/java/technologies/javase/javase-jdk8-downloads.html

[å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] jdk-8u251-macosx-x64.dmg

.image install-avd-to-macos-on-cli/img/oraclejdk.png 450 720

* AdoptOpenJDK - ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

.link https://adoptopenjdk.net/releases.html

[å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] OpenJDK8U-jdk_x64_mac_hotspot_8u252b09.tar.gz

.image install-avd-to-macos-on-cli/img/adoptopenjdk.png 450 720

* AdoptOpenJDK - ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã—ã¦å±•é–‹ã€‚

  % tar zxvf Downloads/OpenJDK8U-jdk_x64_mac_hotspot_8u252b09.tar.gz 

å±•é–‹ã•ã‚ŒãŸã€Œjdk8u252-b09/ã€ã‚’ã€Œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³/ã€é…ä¸‹ã«ç§»å‹•ã€‚

  % mv jdk8u252-b09/ Applications/

* AdoptOpenJDK - ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

ä»»æ„ã®ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã§.zshrcãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€JAVA_HOMEã¨ãƒ‘ã‚¹ã‚’è¿½åŠ ã—ã¦ä¿å­˜ã€‚

  export JAVA_HOME=/Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/Applications/jdk8u252-b09/Contents/Home
  export PATH=$PATH:$JAVA_HOME/bin

zshrcãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿ç›´ã™ã€‚

  % source .zshrc

å‹•ä½œã‚’ç¢ºèªã€‚

  % java -version
  openjdk version "1.8.0_252"
  OpenJDK Runtime Environment (AdoptOpenJDK)(build 1.8.0_252-b09)
  OpenJDK 64-Bit Server VM (AdoptOpenJDK)(build 25.252-b09, mixed mode)

* Zulu Community - ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

.link https://www.azul.com/downloads/zulu-community/

[å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] zulu8.46.0.19-ca-jdk8.0.252-macosx_x64.tar.gz

.image install-avd-to-macos-on-cli/img/zuluopenjdk.png 450 720

* Zulu Community - ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã—ã¦å±•é–‹ã€‚

  % tar zxvf Downloads/zulu8.46.0.19-ca-jdk8.0.252-macosx_x64.tar.gz

å±•é–‹ã•ã‚ŒãŸã€Œzulu8.46.0.19-ca-jdk8.0.252-macosx_x64/ã€ã‚’ã€Œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³/ã€é…ä¸‹ã«ç§»å‹•ã€‚

  % mv zulu8.46.0.19-ca-jdk8.0.252-macosx_x64/ Applications/

* Zulu Community - ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

ä»»æ„ã®ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã§.zshrcãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€JAVA_HOMEã¨ãƒ‘ã‚¹ã‚’è¿½åŠ ã—ã¦ä¿å­˜ã€‚

  export JAVA_HOME=/Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/Applications/zulu8.46.0.19-ca-jdk8.0.252-macosx_x64
  export PATH=$PATH:$JAVA_HOME/bin

zshrcãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿ç›´ã™ã€‚

  % source .zshrc

å‹•ä½œã‚’ç¢ºèªã€‚

  % java -version
  openjdk version "1.8.0_252"
  OpenJDK Runtime Environment (Zulu 8.46.0.19-CA-macosx) (build 1.8.0_252-b14)
  OpenJDK 64-Bit Server VM (Zulu 8.46.0.19-CA-macosx) (build 25.252-b14, mixed mode)

* Android Tools

* äº‹å‰ä½œæ¥­

ã€Œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³/ã€é…ä¸‹ã«ã€Œandroid-sdk/ã€ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¼ã‚’ä½œæˆã€‚

  % mkdir Applications/android-sdk/

* ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

ä»»æ„ã®ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã§.zshrcãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€ANDROID_HOMEã¨ANDROID_SDK_ROOTã‚’è¿½åŠ ã—ã¦ä¿å­˜ã€‚

  export ANDROID_HOME=/Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/Applications/android-sdk
  export ANDROID_SDK_ROOT=/Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/Applications/android-sdk

zshrcãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿ç›´ã™ã€‚

  % source .zshrc

å†…å®¹ã‚’ç¢ºèªã€‚

  % echo $ANDROID_HOME
  /Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/Applications/android-sdk

  % echo $ANDROID_SDK_ROOT
  /Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/Applications/android-sdk

* å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«

- SDK Tools
- SDK Platform Tools
- emulator

* SDK Tools - ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

.link https://developer.android.com/studio#cmdline-tools

[å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] commandlinetools-mac-6200805_latest.zip

.image install-avd-to-macos-on-cli/img/commandlinetools.png 450 720

* SDK Tools - ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã—ã¦å±•é–‹ã€‚

  % unzip Downloads/commandlinetools-mac-6200805_latest.zip

å±•é–‹ã•ã‚ŒãŸã€Œtools/ã€ã‚’ã€Œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³/android-sdk/ã€é…ä¸‹ã«ç§»å‹•ã€‚

  % mv tools/ Applications/android-sdk/

* SDK Tools - ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

ä»»æ„ã®ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã§.zshrcãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€ãƒ‘ã‚¹ã‚’è¿½åŠ ã—ã¦ä¿å­˜ã€‚

  export PATH=$PATH:$ANDROID_SDK_ROOT/tools
  export PATH=$PATH:$ANDROID_SDK_ROOT/tools/bin

zshrcãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿ç›´ã™ã€‚

  % source .zshrc

å‹•ä½œã‚’ç¢ºèªã€‚

  % sdkmanager --sdk_root=$ANDROID_SDK_ROOT --version
  3.6.0

* SDK Platform Tools - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

sdkmanagerã«ã¦ã€"platform-tools"ã‚’ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

  % sdkmanager --sdk_root=$ANDROID_SDK_ROOT "platform-tools"
  [=======================================] 100% Unzipping... platform-tools/systr

* [å‚è€ƒ] SDK Platform Tools - ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰

.link https://developer.android.com/studio/releases/platform-tools#downloads

[å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«] platform-tools_r30.0.1-darwin.zip

.image install-avd-to-macos-on-cli/img/platform-tools.png 450 720

* [å‚è€ƒ] SDK Platform Tools - ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ€ãƒ–ãƒ«ã‚¯ãƒªãƒƒã‚¯ã—ã¦å±•é–‹ã€‚

  % unzip platform-tools_r30.0.1-darwin.zip

å±•é–‹ã•ã‚ŒãŸã€Œplatform-tools/ã€ã‚’ã€Œã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³/android-sdk/ã€é…ä¸‹ã«ç§»å‹•ã€‚

  % mv platform-tools/ Applications/android-sdk/

* SDK Platform Tools - ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

ä»»æ„ã®ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã§.zshrcãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€ãƒ‘ã‚¹ã‚’è¿½åŠ ã—ã¦ä¿å­˜ã€‚

  export PATH=$PATH:$ANDROID_SDK_ROOT/platform-tools

zshrcãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿ç›´ã™ã€‚

  % source .zshrc

å‹•ä½œã‚’ç¢ºèªã€‚

  % adb version
  Android Debug Bridge version 1.0.41
  Version 30.0.1-6435776
  Installed as /Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/Applications/android-sdk/platform-tools/adb

* emulator - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

sdkmanagerã«ã¦ã€"emulator"ã‚’ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

  % sdkmanager --sdk_root=$ANDROID_SDK_ROOT emulator
  [=======================================] 100% Unzipping... emulator/lib/pc-bios

* emulator - ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

ä»»æ„ã®ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã§.zshrcãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€ãƒ‘ã‚¹ã‚’è¿½åŠ ã—ã¦ä¿å­˜ã€‚

  export PATH=$PATH:$ANDROID_SDK_ROOT/emulator

zshrcãƒ•ã‚¡ã‚¤ãƒ«ã‚’èª­ã¿ç›´ã™ã€‚

  % source .zshrc

å‹•ä½œã‚’ç¢ºèªã€‚

  % emulator -version 
  Android emulator version 30.0.12.0 (build_id 6466327) (CL:N/A)
  Copyright (C) 2006-2017 The Android Open Source Project and many others.
  This program is a derivative of the QEMU CPU emulator (www.qemu.org).
  ...

* [æœ€çµ‚çµæœ] .zshrcãƒ•ã‚¡ã‚¤ãƒ«ã¸ã®è¿½åŠ å†…å®¹

  % cat .zshrc
  export PATH=$PATH:/Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/Applications/flutter/bin
  
  export JAVA_HOME=/Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/Applications/jdk8u252-b09/Contents/Home
  #export JAVA_HOME=/Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/Applications/zulu8.46.0.19-ca-jdk8.0.252-macosx_x64
  export PATH=$PATH:$JAVA_HOME/bin
  
  export ANDROID_HOME=/Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/Applications/android-sdk
  export ANDROID_SDK_ROOT=/Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/Applications/android-sdk
  export PATH=$PATH:$ANDROID_SDK_ROOT/tools
  export PATH=$PATH:$ANDROID_SDK_ROOT/tools/bin
  export PATH=$PATH:$ANDROID_SDK_ROOT/platform-tools
  export PATH=$PATH:$ANDROID_SDK_ROOT/emulator

* Androidä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹

* APIãƒ¬ãƒ™ãƒ«ã®ç¢ºèª

ä»Šå›ã‚¿ãƒ¼ã‚²ãƒƒãƒˆã«ã—ãŸã„ç«¯æœ«ã¯ã€ŒNexus 7 (2013)ã€ã§Android 6.0.1ã€‚

.link https://developer.android.com/guide/topics/manifest/uses-sdk-element#ApiLevels

ä¸Šè¨˜ã‚µã‚¤ãƒˆã‹ã‚‰ã€Android 6.0ã®APIãƒ¬ãƒ™ãƒ«ã¯ã€Œ23ã€ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã€‚

.image install-avd-to-macos-on-cli/img/apilevels.png 396 634

* å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«ã®ç¢ºèª

sdkmanagerã«ã¦ã€APIãƒ¬ãƒ™ãƒ«ãŒ23ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒªã‚¹ãƒˆã‚¢ãƒƒãƒ—ã€‚

  % sdkmanager --sdk_root=$ANDROID_SDK_ROOT --list | grep 23 
    add-ons;addon-google_apis-google-23               | 1      | Google APIs                                                         
    build-tools;23.0.1                                | 23.0.1 | Android SDK Build-Tools 23.0.1                                      
    build-tools;23.0.2                                | 23.0.2 | Android SDK Build-Tools 23.0.2                                      
    build-tools;23.0.3                                | 23.0.3 | Android SDK Build-Tools 23.0.3                                      
    platforms;android-23                              | 3      | Android SDK Platform 23                                             
    sources;android-23                                | 1      | Sources for Android 23                                              
    system-images;android-23;android-tv;armeabi-v7a   | 12     | Android TV ARM EABI v7a System Image                                
    system-images;android-23;android-tv;x86           | 19     | Android TV Intel x86 Atom System Image                              
    system-images;android-23;android-wear;armeabi-v7a | 6      | Android Wear ARM EABI v7a System Image                              
    system-images;android-23;android-wear;x86         | 6      | Android Wear Intel x86 Atom System Image                            
    system-images;android-23;default;armeabi-v7a      | 6      | ARM EABI v7a System Image                                           
    system-images;android-23;default;x86              | 10     | Intel x86 Atom System Image                                         
    system-images;android-23;default;x86_64           | 10     | Intel x86 Atom_64 System Image                                      
    system-images;android-23;google_apis;armeabi-v7a  | 32     | Google APIs ARM EABI v7a System Image                               
    system-images;android-23;google_apis;x86          | 32     | Google APIs Intel x86 Atom System Image                             
    system-images;android-23;google_apis;x86_64       | 32     | Google APIs Intel x86 Atom_64 System Image                          

* å¯¾è±¡ãƒ•ã‚¡ã‚¤ãƒ«

- build-tools
- platforms
- system-images

* build-tools - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

sdkmanagerã«ã¦ã€"build-tools;23.0.3"ã‚’ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

  % sdkmanager --sdk_root=$ANDROID_SDK_ROOT "build-tools;23.0.3" 
  [=======================================] 100% Unzipping... android-6.0/zipalign

* platforms - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

sdkmanagerã«ã¦ã€"platforms;android-23"ã‚’ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¸ã®åŒæ„ãŒæ±‚ã‚ã‚‰ã‚ŒãŸå ´åˆã€yã‚’å…¥åŠ›ã—ã¦[enter]ã‚­ãƒ¼ã‚’æŠ¼ä¸‹ã—ã¦ç¶šè¡Œã€‚

  % sdkmanager --sdk_root=$ANDROID_SDK_ROOT "platforms;android-23"
  License android-sdk-license:            ] 10% Computing updates...              
  ---------------------------------------
  Terms and Conditions
  
  This is the Android Software Development Kit License Agreement
  ...
  January 16, 2019
  ---------------------------------------
  Accept? (y/N): y
  [=======================================] 100% Unzipping... android-6.0/source.p

* system-images - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

sdkmanagerã«ã¦ã€"system-images;android-23;default;x86_64"ã‚’ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

  % sdkmanager --sdk_root=$ANDROID_SDK_ROOT "system-images;android-23;default;x86_64"
  [=======================================] 100% Unzipping... x86_64/system.img

* Flutterã«å¿…è¦ãªAPIãƒ¬ãƒ™ãƒ«

flutter doctorã«ã¦ã€Flutterã«ã¯APIãƒ¬ãƒ™ãƒ«ãŒã€Œ28ã€ã®ã‚‚ã®ãŒå¿…è¦ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã€‚

  % flutter doctor -v
  ...
  [!] Android toolchain - develop for Android devices (Android SDK version 23.0.3)
      â€¢ Android SDK at /Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/Applications/android-sdk
      âœ— Flutter requires Android SDK 28 and the Android BuildTools 28.0.3
        To update using sdkmanager, run:
          "/Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/Applications/android-sdk/tools/bin/sdkmanager" "platforms;android-28" "build-tools;28.0.3"
        or visit https://flutter.dev/docs/get-started/install/macos#android-setup for detailed instructions.
  ...

* Flutterç”¨ - ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

sdkmanagerã«ã¦ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

- "platforms;android-28"
- "build-tools;28.0.3"

  % sdkmanager --sdk_root=$ANDROID_SDK_ROOT "platforms;android-28" "build-tools;28.0.3"
  [=======================================] 100% Unzipping... android-9/zipalign

ã¾ãŸã¯

  % sdkmanager --sdk_root=$ANDROID_SDK_ROOT "platforms;android-28"
  [=======================================] 100% Unzipping... android-9/framework.

  % sdkmanager --sdk_root=$ANDROID_SDK_ROOT "build-tools;28.0.3"
  [=======================================] 100% Unzipping... android-9/zipalign

* Androidãƒ©ã‚¤ã‚»ãƒ³ã‚¹èªè¨¼

* ç¢ºèª

flutter doctorã«ã¦ã€Androidãƒ©ã‚¤ã‚»ãƒ³ã‚¹èªè¨¼ãŒã§ãã¦ã„ãªã„ã“ã¨ã‚’ç¢ºèªã€‚

  % flutter doctor
  ...
  [!] Android toolchain - develop for Android devices (Android SDK version 28.0.3)
      âœ— Android license status unknown.
        Try re-installing or updating your Android SDK Manager.
        See https://developer.android.com/studio/#downloads or visit visit https://flutter.dev/docs/get-started/install/macos#android-setup for detailed instructions.
  ...

ã€Œ--android-licensesã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æŒ‡å®šã—ã¦å®Ÿè¡Œã™ã‚‹ã‚‚ã€è§£æ¶ˆã•ã‚Œãªã„ã€‚

  % flutter doctor --android-licenses
  ...
  [!] Android toolchain - develop for Android devices (Android SDK version 28.0.3)
      âœ— Android license status unknown.
        Try re-installing or updating your Android SDK Manager.
        See https://developer.android.com/studio/#downloads or visit visit https://flutter.dev/docs/get-started/install/macos#android-setup for detailed instructions.
  ...

* åŸå› 

flutter doctorã§ã¯ã€å†…éƒ¨ã§sdkmanagerã‚’å‘¼ã³å‡ºã—ã¦ã„ã‚‹ãŒã€ãã®æ™‚ã«

- --sdk_root=$ANDROID_SDK_ROOT

ã‚ªãƒ—ã‚·ãƒ§ãƒ³ãªã—ã§å®Ÿè¡Œã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ã‚¨ãƒ©ãƒ¼ã¨ãªã£ã¦ã„ã‚‹ã€‚

ã“ã‚Œã¯commandlinetools-6200805ã«ãªã£ã¦ã‹ã‚‰ã®ä¸å…·åˆã®æ¨¡æ§˜ã€‚

* å¯¾ç­–

sdkmanagerã«ã€Œ--sdk_root=$ANDROID_SDK_ROOTã€ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’åŸ‹ã‚è¾¼ã‚€ã€‚

ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’ç¢ºèªã™ã‚‹ã€‚ï¼ˆ-r-xr-xr-x@ï¼šæ›¸ãè¾¼ã¿ä¸å¯ï¼‰

  % ls -l $ANDROID_SDK_ROOT/tools/bin/sdkmanager 
  -r-xr-xr-x@ 1 ãƒ¦ãƒ¼ã‚¶ãƒ¼å  staff  5318  1  1  2010 /Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/Applications/android-sdk/tools/bin/sdkmanager

chmodã«ã¦ã€ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’ã€Œæ›¸ãè¾¼ã¿å¯èƒ½ã€ã«å¤‰æ›´ã™ã‚‹ã€‚

  % chmod 755 $ANDROID_SDK_ROOT/tools/bin/sdkmanager

ãƒ•ã‚¡ã‚¤ãƒ«ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã®å¤‰æ›´ã‚’ç¢ºèªã™ã‚‹ã€‚ï¼ˆ-rwxr-xr-x@ï¼šæ›¸ãè¾¼ã¿å¯èƒ½ï¼‰

  % ls -l $ANDROID_SDK_ROOT/tools/bin/sdkmanager    
  -rwxr-xr-x@ 1 ãƒ¦ãƒ¼ã‚¶ãƒ¼å  staff  5318  1  1  2010 /Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/Applications/android-sdk/tools/bin/sdkmanager

* å¯¾ç­–

ä»»æ„ã®ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã§sdkmanagerã‚’é–‹ãã€‚

  % vim $ANDROID_SDK_ROOT/tools/bin/sdkmanager

æœ€çµ‚è¡Œã‚’æ›¸ãæ›ãˆã¦ä¿å­˜ã™ã‚‹ã€‚

- å¤‰æ›´å‰

  exec "$JAVACMD" "$@"

- å¤‰æ›´å¾Œ

  exec "$JAVACMD" "$@" --sdk_root=$ANDROID_SDK_ROOT

* å†ç¢ºèª

flutter doctorã«ã¦ã€è­¦å‘ŠãŒAndoridãƒ©ã‚¤ã‚»ãƒ³ã‚¹èªè¨¼ä¸è¶³ã«å¤‰ã‚ã£ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã€‚

  % flutter doctor
  ...
  [!] Android toolchain - develop for Android devices (Android SDK version 28.0.3)
      ! Some Android licenses not accepted.  To resolve this, run: flutter doctor --android-licenses
  ...

sdkmanagerã«ã¦ã€Andoridãƒ©ã‚¤ã‚»ãƒ³ã‚¹èªè¨¼ã‚’è¡Œã†ã€‚

ãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã¸ã®åŒæ„ãŒæ±‚ã‚ã‚‰ã‚ŒãŸå ´åˆã€yã‚’å…¥åŠ›ã—ã¦[enter]ã‚­ãƒ¼ã‚’æŠ¼ä¸‹ã—ã¦ç¶šè¡Œã€‚

  % sdkmanager --licenses
  6 of 7 SDK package licenses not accepted. 100% Computing updates...             
  Review licenses that have not been accepted (y/N)? y
  ...
  Accept? (y/N): y
  All SDK package licenses accepted

* å†ç¢ºèª

flutter doctorã«ã¦ã€Android toolchainã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—å®Œäº†ã‚’ç¢ºèªã€‚

  % flutter doctor       
  ...
  [âœ“] Android toolchain - develop for Android devices (Android SDK version 28.0.3)
  ...

* Androidä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹ä½œæˆ

* ãƒ‡ãƒã‚¤ã‚¹IDã®ç¢ºèª

avdmanagerã«ã¦ã€"Nexus 7 2013"ã®ãƒ‡ãƒã‚¤ã‚¹IDãŒã€Œ13ã€ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã€‚

  % avdmanager list device | grep "Nexus 7" 
  id: 13 or "Nexus 7 2013"
      Name: Nexus 7
  id: 14 or "Nexus 7"
      Name: Nexus 7 (2012)

* æ—¢å­˜ã®ä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹ã®å‰Šé™¤

ä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹åã‚’ã€ŒNexus_7_2013ã€ã¨ã™ã‚‹ã€‚

avdmanagerã«ã¦ã€åŒåã®ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒã‚ã‚Œã°å‰Šé™¤ã€‚

  % avdmanager delete avd -n Nexus_7_2013
  Deleting file /Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/.android/avd/Nexus_7_2013.ini
  Deleting folder /Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/.android/avd/Nexus_7_2013.avd
  
  AVD 'Nexus_7_2013' deleted.

* ä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹ã®ä½œæˆ

avdmanagerã«ã¦ã€ãƒ‡ãƒã‚¤ã‚¹IDã€Œ13ã€ã§ä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹ã€ŒNexus_7_2013ã€ã‚’ä½œæˆã€‚

  % avdmanager create avd -n Nexus_7_2013 -d 13 -k "system-images;android-23;default;x86_64"
  ...
  Warning: Observed package id 'emulator' in inconsistent location '/Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/Applications/android-sdk/emulator' (Expected '/Users/ãƒ¦ãƒ¼ã‚¶ãƒ¼å/Applications/emulator')
  ...
  Auto-selecting single ABI x86_64========] 100% Fetch remote repository...       

Androidãƒ„ãƒ¼ãƒ«é¡ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«å ´æ‰€ã«ã¤ã„ã¦è­¦å‘ŠãŒå‡ºã‚‹ãŒã€ä½œæˆã«ã¯å•é¡Œãªã—ã€‚

* ä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®ä¿®æ­£

ä»»æ„ã®ã‚¨ãƒ‡ã‚£ã‚¿ãƒ¼ã§ä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹ã®config.iniãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ãã€‚

  % vim .android/avd/Nexus_7_2013.avd/config.ini 

image.sysdir.1ã®å€¤ã‚’ä¿®æ­£ã€‚

- å¤‰æ›´å‰

  image.sysdir.1=android-sdk/system-images/android-23/default/x86_64/
  
- å¤‰æ›´å¾Œ
  
  image.sysdir.1=system-images/android-23/default/x86_64/

* ä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹ã®èµ·å‹•

emulatorã«ã¦ã€ä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹ã‚’èµ·å‹•ã€‚

  % emulator -avd Nexus_7_2013

ã¾ãŸã¯

  % emulator @Nexus_7_2013

* ä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹ã®åœæ­¢

ä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹ã®å³å´ã®ãƒœã‚¿ãƒ³åˆ—ã‹ã‚‰ã€ŒCloseã€ã¾ãŸã¯ã€ŒPowerã€ã®ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯ã€‚

.image install-avd-to-macos-on-cli/img/emulator.png 547 362

* Flutterã‚¢ãƒ—ãƒªä½œæˆ

* Flutterã‚¢ãƒ—ãƒªä½œæˆ

flutter createã«ã¦ã€myappãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã€‚

  % flutter create myapp
  Creating project myapp...
    ...
  Running "flutter pub get" in myapp...                               2.3s
  Wrote 72 files.
  
  All done!
  ...
  
  Run "flutter doctor" for information about installing additional components.
  
  In order to run your application, type:
  
    $ cd myapp
    $ flutter run
  
  Your application code is in myapp/lib/main.dart.

* Flutterã‚¢ãƒ—ãƒªèµ·å‹•

myappãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¼å†…ã«ç§»å‹•ã€‚

  % cd myapp

flutter runã«ã¦ã€ã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã€‚â†’ æ¥ç¶šãƒ‡ãƒã‚¤ã‚¹ãªã—ã€‚

  % flutter run
  No supported devices connected.

flutter devicesã«ã¦ã€æ¥ç¶šå¯èƒ½ãªãƒ‡ãƒã‚¤ã‚¹ãŒå­˜åœ¨ã™ã‚‹ã‹ç¢ºèªã€‚

  % flutter devices
  No devices detected.
  
  Run "flutter emulators" to list and start any available device emulators.
  
  If you expected your device to be detected, please run "flutter doctor" to diagnose potential issues. You may also try increasing the time to wait
  for connected devices with the --timeout flag. Visit https://flutter.dev/setup/ for troubleshooting tips.

* Flutterã‚¢ãƒ—ãƒªèµ·å‹•

flutter emulatorsã«ã¦ã€ä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹ã€ŒNexus_7_2013ã€ã‚’èµ·å‹•ã™ã‚‹ã€‚

  % flutter emulators --launch Nexus_7_2013

flutter devicesã«ã¦ã€æ¥ç¶šå¯èƒ½ãªãƒ‡ãƒã‚¤ã‚¹ã¨ã—ã¦å­˜åœ¨ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã€‚

  % flutter devices          
  1 connected device:
  
  Android SDK built for x86 64 â€¢ emulator-5554 â€¢ android-x64 â€¢ Android 6.0 (API 23) (emulator)

* Flutterã‚¢ãƒ—ãƒªèµ·å‹•

flutter runã«ã¦ã€ã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã€‚

  % flutter run
  Using hardware rendering with device Android SDK built for x86 64. If you get graphics artifacts, consider enabling software rendering with "--enable-software-rendering".
  Launching lib/main.dart on Android SDK built for x86 64 in debug mode...
  Running Gradle task 'assembleDebug'...                                  
  Running Gradle task 'assembleDebug'... Done                        51.8s
  âœ“ Built build/app/outputs/apk/debug/app-debug.apk.
  Installing build/app/outputs/apk/app.apk...                         3.4s
  Syncing files to device Android SDK built for x86 64...            431ms
  
  Flutter run key commands.
  r Hot reload. ğŸ”¥ğŸ”¥ğŸ”¥
  R Hot restart.
  h Repeat this help message.
  d Detach (terminate "flutter run" but leave application running).
  c Clear the screen
  q Quit (terminate the application on the device).
  An Observatory debugger and profiler on Android SDK built for x86 64 is available at: http://127.0.0.1:58266/hL5wRDO6rZo=/

ä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹ãŒèµ·å‹•ã—ã¦ã‚¢ãƒ—ãƒªãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¾ã§ã«ã€æ•°åˆ†ã€œæ•°ååˆ†ã‹ã‹ã‚‹å ´åˆã‚ã‚Šã€‚

* å®Œæˆï¼q@v@p

.image install-avd-to-macos-on-cli/img/vscode_emulator.png 576 922

* ã¾ã¨ã‚

* ãƒãƒã‚Šå‡¦

commandlinetools-6200805ã«åŒæ¢±ã•ã‚Œã¦ã„ã‚‹sdkmanagerã®æŒ™å‹•ãŒæ€ªã—ã„

- æœ¬è³‡æ–™ã®æ–¹æ³•ã§sdkmanagerã‚’ä¿®æ­£ã™ã‚‹ã‹ã€æ¬¡ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã®ãƒªãƒªãƒ¼ã‚¹ã‚’å¾…ã¤ã€‚

  exec "$JAVACMD" "$@" --sdk_root=$ANDROID_SDK_ROOT

ä»®æƒ³ãƒ‡ãƒã‚¤ã‚¹ãŒèµ·å‹•ã—ãªã„

- config.iniãƒ•ã‚¡ã‚¤ãƒ«å†…ã®system-imagesã®ãƒ‘ã‚¹ã‚’æœ¬è³‡æ–™ã®å†…å®¹ã§ä¿®æ­£ã—ã¦ã¿ã‚‹ã€‚

  image.sysdir.1=system-images/android-23/default/x86_64/

* ä»Šå›ã®ä½œæ¥­ã«ã‚ˆã‚‹ãƒ‡ã‚£ã‚¹ã‚¯ä½¿ç”¨é‡ï¼šç´„11GB

- ç¢ºèªã‚³ãƒãƒ³ãƒ‰

  % du -k [ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãƒ¼å]

- å®Ÿè¡Œçµæœï¼ˆå˜ä½ï¼šKBï¼‰

  // Flutter
  2143328   Applications/flutter
  416       myapp

  // Android
  193996    Applications/jdk8u252-b09
  5159496   Applications/android-sdk
  3717340   .android

- [å‚è€ƒ] Visual Studio Codeï¼šç´„250MBï¼ˆFlutterï¼†Dartã‚¨ã‚¯ã‚¹ãƒ†ãƒ³ã‚·ãƒ§ãƒ³ã‚’å«ã‚€ï¼‰

  // Visula Studio Code
  245480    /Applications/Visual Studio Code.app
  9948      .vscode
